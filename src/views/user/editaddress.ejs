<%- include('../partials/user/header') %>

<body>
  <style>
    :root {
      --primary-color: #f53f85;
      --secondary-color: #f8f9fa;
      --accent-color: #4a6fdc;
      --text-color: #333;
      --border-color: #ddd;
      --success-color: #28a745;
    }

    .logout-button {
      background-color: #f53f85;
      color: white;
      border: none;
      border-radius: 50px;
      padding: 10px 20px;
      text-align: center;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .logout-button i {
      margin-right: 8px;
      font-size: 16px;
    }

    .logout-button:hover {
      background-color: #f53f85;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }

    .logout-button:active {
      transform: translateY(0);
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2);
    }

    /* Dashboard Layout */
    .dashboard-container {
      display: flex;
      max-width: 1200px;
      margin: 20px auto;
      gap: 20px;
    }

    .account-tabs-menu {
      flex: 0 0 250px;
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      height: fit-content;
    }

    .account-tabs-menu ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .account-tabs-menu li {
      margin-bottom: 10px;
    }

    .account-tabs-menu a {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      border-radius: 8px;
      color: var(--text-color);
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .account-tabs-menu a i {
      margin-right: 10px;
      font-size: 18px;
    }

    .account-tabs-menu a.active {
      background-color: var(--primary-color);
      color: white;
    }

    .account-tabs-menu a:hover:not(.active) {
      background-color: var(--secondary-color);
    }

    .dashboard-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* Address Form Section */
    .address-form-section {
      background-color: white;
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .section-header h2 {
      margin: 0;
      font-size: 24px;
    }

    .section-header .btn-back {
      background-color: var(--accent-color);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .section-header .btn-back i {
      margin-right: 8px;
    }

    .section-header .btn-back:hover {
      background-color: #3d5dbb;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* Form Styling */
    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: var(--text-color);
    }

    .form-control {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    .form-control:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 0 2px rgba(245, 63, 133, 0.2);
    }

    .form-row {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
    }

    .form-col {
      flex: 1;
    }

    .form-checkbox {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 10px;
      margin-bottom: 25px;
    }

    .form-checkbox input {
      width: 18px;
      height: 18px;
      accent-color: var(--primary-color);
    }

    .form-checkbox label {
      margin-bottom: 0;
      cursor: pointer;
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 15px;
      margin-top: 30px;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 5px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
    }

    .btn i {
      margin-right: 8px;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
      border: none;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .btn-primary:hover {
      background-color: #e52f75;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .btn-secondary {
      background-color: #f1f1f1;
      color: #333;
      border: 1px solid #ddd;
    }

    .btn-secondary:hover {
      background-color: #e0e0e0;
      transform: translateY(-2px);
    }

    @media (max-width: 768px) {
      .dashboard-container {
        flex-direction: column;
      }

      .account-tabs-menu {
        flex: auto;
      }

      .form-row {
        flex-direction: column;
        gap: 0;
      }
    }
  </style>

  <div class="dashboard-container">
    <!-- Account Menu -->
    <div class="account-tabs-menu">
      <ul>
        <li>
          <a href="/profile" 
            ><i class="bx bxs-user"></i>Profile</a
          >
        </li>
        <li>
          <a href="/orders"><i class="bx bxs-shopping-bag"></i> Orders</a>
        </li>
        <li>
          <a href="/address" class="active"><i class="bx bxs-map"></i> Addresses</a>
        </li>
        <li>
          <a href="/wallet"><i class="bx bxs-wallet"></i>wallet</a>
        </li>
        <li>
          <a href="/changenewpassword"
            ><i class="bx bx-lock-alt"></i>Change Password</a
          >
        </li>
      </ul>
      <br /><br /><br />
      <button onclick="logout()" class="logout-button">
        <i class="bx bx-log-out"></i> Logout
      </button>
    </div>

    <!-- Dashboard Content -->
    <div class="dashboard-content">
      <!-- Address Form Section -->
      <div class="address-form-section">
        <div class="section-header">
          <h2>Edit Address</h2>
          <a href="/address" class="btn-back">
            <i class="bx bx-arrow-back"></i> Back to Addresses
          </a>
        </div>

        <form id="editAddressForm" action="/editaddress/<%= address.address[0]._id %>" method="POST">
            <input type="hidden" name="id" value="<%= address._id %>">
            
            <!-- Assuming you've extracted the specific address object from the array -->
            <% const specificAddress = address.address[0]; %>
            
            <div class="form-group">
              <label for="saveAs">Address Type*</label>
              <select id="saveAs" name="saveAs" class="form-control" required>
                <option value="">Select Type</option>
                <option value="Home" <%= specificAddress.saveAs === 'Home' ? 'selected' : '' %>>Home</option>
                <option value="Work" <%= specificAddress.saveAs === 'Work' ? 'selected' : '' %>>Work</option>
                <option value="Other" <%= specificAddress.saveAs === 'Other' ? 'selected' : '' %>>Other</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="name">Full Name*</label>
              <input type="text" id="name" name="name" class="form-control" value="<%= specificAddress.name %>" required>
            </div>
            
            <div class="form-group">
              <label for="email">Email*</label>
              <input type="email" id="email" name="email" class="form-control" value="<%= specificAddress.email %>" required>
            </div>
            
            <div class="form-group">
              <label for="number">Phone Number*</label>
              <input type="tel" id="number" name="number" class="form-control" value="<%= specificAddress.number %>" required>
            </div>
            
            <div class="form-group">
              <label for="houseName">House/Apartment Name*</label>
              <input type="text" id="houseName" name="houseName" class="form-control" value="<%= specificAddress.houseName %>" required>
            </div>
            
            <div class="form-group">
              <label for="street">Street*</label>
              <input type="text" id="street" name="street" class="form-control" value="<%= specificAddress.street %>" required>
            </div>
            
            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="city">City*</label>
                  <input type="text" id="city" name="city" class="form-control" value="<%= specificAddress.city %>" required>
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <label for="state">State/Province*</label>
                  <input type="text" id="state" name="state" class="form-control" value="<%= specificAddress.state %>" required>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="pincode">Postal/Zip Code*</label>
                  <input type="text" id="pincode" name="pincode" class="form-control" value="<%= specificAddress.pincode %>" required>
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <label for="country">Country*</label>
                  <input type="text" id="country" name="country" class="form-control" value="<%= specificAddress.country %>" required>
                </div>
              </div>
            </div>
            
            <div class="form-checkbox">
              <input type="checkbox" id="isDefault" name="isDefault" <%= specificAddress.isDefault ? 'checked' : '' %>>
              <label for="isDefault">Set as default address</label>
            </div>
            
            <div class="form-actions">
              <a href="/address" class="btn btn-secondary">
                <i class="bx bx-x"></i> Cancel
              </a>
              <button type="submit" class="btn btn-primary">
                <i class="bx bx-save"></i> Update Address
              </button>
            </div>
          </form>

  <script>
    // Logout confirmation
    function logout() {
      Swal.fire({
        title: 'Are you sure?',
        text: 'Do you want to continue to logout?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#000000',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Logout',
        cancelButtonText: 'Cancel',
      }).then((result) => {
        if (result.isConfirmed) {
          window.location.href = '/logout';
        }
      });
    }

    // Form validation
    document.getElementById('editAddressForm').addEventListener('submit', function(e) {
      // Basic validation can be added here if needed
      
      // Show loading state on button
      const submitBtn = this.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="bx bx-loader-alt bx-spin"></i> Updating...';
      submitBtn.disabled = true;
      
      // Form will submit normally
    });
  </script>
</body>
<%- include('../partials/user/footer') %>